<!DOCTYPE html><html><head><title>te9yie</title><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="google-site-verification" content="iMWdKZ02K2Yzj9AtOP4cl-40F5DJp-YJLQDzv9vQgMk"/><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="te9yie.github.io"/><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/509606b329852c74360b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/509606b329852c74360b.css" data-n-g=""/><link rel="preload" href="/_next/static/css/18a619bacb7468e88ab5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/18a619bacb7468e88ab5.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-1f0b73d383aed819e4f2.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.29f9e2f3d4a33bafbaa5.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.3a16fc34825ffc7ba561.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-be08fdd24fededd721c6.js" as="script"/><link rel="preload" href="/_next/static/chunks/7ac61503aba6d10b58e3c266d97d99b7b5b3721a.c1b518faff21babf1a9f.js" as="script"/><link rel="preload" href="/_next/static/chunks/5f8a2089eac11fe3b358516a6b612033195d4834.64ceb811d7eabbf018a0.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/index-9b12f7e5ac7c7e4e6afc.js" as="script"/></head><body><div id="__next"><header><nav><ul><li><a id="site-name" href="/"><h1>te9yie</h1></a></li><li><a href="/b">Blog</a></li><li><a href="/w">Wiki</a></li><li><a href="/search">Search</a></li></ul></nav></header><article><h2><a class="index_permalink__UOudO" href="/b/2021-03-15">2021-03-15</a></h2><p>順番がおかしい気もするけど<a class="wiki-link" href="/w/JavaScript">JavaScript</a>でインタラクティブなものを作ろうと思った。</p><p><a href="https://p5js.org/">p5.js</a>や<a href="https://threejs.org/">Three.js</a>を少し触ってみたり。サンプルをなぞるだけでなく何かを作らないと調べるモチベーションが湧かないな。</p></article><article><h2><a class="index_permalink__UOudO" href="/b/2021-03-11">2021-03-11</a></h2><p><a class="wiki-link" href="/w/WebAssembly">WebAssembly</a>でマウスイベントの処理もやってみた。</p><p><a href="https://github.com/te9yie/wasm-mouse-event/">https://github.com/te9yie/wasm-mouse-event/</a></p><div><iframe
    title="wasm-mouse-event"
    width="430"
    height="230"
    src="https://te9yie.github.io/wasm-mouse-event/">
</iframe></div><p>楽しくなってきた。</p></article><article><h2><a class="index_permalink__UOudO" href="/b/2021-03-10">2021-03-10</a></h2><p><a class="wiki-link" href="/w/webpack">webpack</a>のことを調べて最新の<a class="wiki-link" href="/w/webpack">webpack</a>でも<a class="wiki-link" href="/w/WebAssembly">WebAssembly</a>が使えるようになった。<a href="https://rustwasm.github.io/docs/wasm-bindgen/">The <code>wasm-bindgen</code> Guide</a>を読みながら、アニメーションするものを作ってみた。</p><p><a href="https://github.com/te9yie/wasm-bounce-ball">https://github.com/te9yie/wasm-bounce-ball</a></p><div><iframe
    title="wasm-bounce-ball"
    width="430"
    height="230"
    src="https://te9yie.github.io/wasm-bounce-ball">
</iframe></div><hr/><p><code>Window.requestAnimationFrame()</code>の呼び出しが難解。</p><p><a class="wiki-link" href="/w/JavaScript">JavaScript</a>でもクロージャを作って、その中で自分自身を渡すみたいな作りになる。</p><pre><code class="language-javascript">const step = (now) =&gt; {
    ...
    window.requestAnimationFrame(step);
};
window.requestAnimationFrame(step);</code></pre><p><a class="wiki-link" href="/w/Rust">Rust</a>だとこんな感じ。クロージャの中で自分自身を使いたいから先に変数は定義しておいて、登録用とクロージャ用に<code>Rc</code>で共有して、あとで代入するから<code>RefCell</code>にして――みたいな。</p><pre><code class="language-rust">let f = Rc::new(RefCell::new(None));
let ff = Rc::clone(&amp;f);
*ff.borrow_mut() = Some(Closure::wrap(Box::new(move |now| {
    ...
    request_animation_frame(f.borrow().as_ref().unwrap());
}) as Box&lt;dyn FnMut(f64)&gt;));
request_animation_frame(ff.borrow().as_ref().unwrap());</code></pre><p>マウスやキーボードなどの入力も取れるようになると、もう少し面白いものも作れそうだ。</p></article><footer>© <!-- -->2021<!-- --> <!-- -->te9yie</footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":[{"id":"2021-03-15","content":"順番がおかしい気もするけど[[JavaScript]]でインタラクティブなものを作ろうと思った。\n\n[p5.js](https://p5js.org/)や[Three.js](https://threejs.org/)を少し触ってみたり。サンプルをなぞるだけでなく何かを作らないと調べるモチベーションが湧かないな。\n"},{"id":"2021-03-11","content":"[[WebAssembly]]でマウスイベントの処理もやってみた。\n\nhttps://github.com/te9yie/wasm-mouse-event/\n\n\u003ciframe\n    title=\"wasm-mouse-event\"\n    width=\"430\"\n    height=\"230\"\n    src=\"https://te9yie.github.io/wasm-mouse-event/\"\u003e\n\u003c/iframe\u003e\n\n楽しくなってきた。\n"},{"id":"2021-03-10","content":"[[webpack]]のことを調べて最新の[[webpack]]でも[[WebAssembly]]が使えるようになった。[The `wasm-bindgen` Guide](https://rustwasm.github.io/docs/wasm-bindgen/)を読みながら、アニメーションするものを作ってみた。\n\nhttps://github.com/te9yie/wasm-bounce-ball\n\n\u003ciframe\n    title=\"wasm-bounce-ball\"\n    width=\"430\"\n    height=\"230\"\n    src=\"https://te9yie.github.io/wasm-bounce-ball\"\u003e\n\u003c/iframe\u003e\n\n---\n\n`Window.requestAnimationFrame()`の呼び出しが難解。\n\n[[JavaScript]]でもクロージャを作って、その中で自分自身を渡すみたいな作りになる。\n\n```javascript\nconst step = (now) =\u003e {\n    ...\n    window.requestAnimationFrame(step);\n};\nwindow.requestAnimationFrame(step);\n```\n\n[[Rust]]だとこんな感じ。クロージャの中で自分自身を使いたいから先に変数は定義しておいて、登録用とクロージャ用に`Rc`で共有して、あとで代入するから`RefCell`にして――みたいな。\n\n```rust\nlet f = Rc::new(RefCell::new(None));\nlet ff = Rc::clone(\u0026f);\n*ff.borrow_mut() = Some(Closure::wrap(Box::new(move |now| {\n    ...\n    request_animation_frame(f.borrow().as_ref().unwrap());\n}) as Box\u003cdyn FnMut(f64)\u003e));\nrequest_animation_frame(ff.borrow().as_ref().unwrap());\n```\n\nマウスやキーボードなどの入力も取れるようになると、もう少し面白いものも作れそうだ。\n"}]},"__N_SSG":true},"page":"/","query":{},"buildId":"6ITGa_4BtWY_kkzQctGtQ","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-4f4acd756cef4fe6da1b.js"></script><script src="/_next/static/chunks/main-1f0b73d383aed819e4f2.js" async=""></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.29f9e2f3d4a33bafbaa5.js" async=""></script><script src="/_next/static/chunks/commons.3a16fc34825ffc7ba561.js" async=""></script><script src="/_next/static/chunks/pages/_app-be08fdd24fededd721c6.js" async=""></script><script src="/_next/static/chunks/7ac61503aba6d10b58e3c266d97d99b7b5b3721a.c1b518faff21babf1a9f.js" async=""></script><script src="/_next/static/chunks/5f8a2089eac11fe3b358516a6b612033195d4834.64ceb811d7eabbf018a0.js" async=""></script><script src="/_next/static/chunks/pages/index-9b12f7e5ac7c7e4e6afc.js" async=""></script><script src="/_next/static/6ITGa_4BtWY_kkzQctGtQ/_buildManifest.js" async=""></script><script src="/_next/static/6ITGa_4BtWY_kkzQctGtQ/_ssgManifest.js" async=""></script></body></html>