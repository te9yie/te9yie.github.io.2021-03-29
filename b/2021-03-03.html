<!DOCTYPE html><html><head><title>2021-03-03 | te9yie</title><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="google-site-verification" content="iMWdKZ02K2Yzj9AtOP4cl-40F5DJp-YJLQDzv9vQgMk"/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/509606b329852c74360b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/509606b329852c74360b.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-1f0b73d383aed819e4f2.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.29f9e2f3d4a33bafbaa5.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.3a16fc34825ffc7ba561.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-be08fdd24fededd721c6.js" as="script"/><link rel="preload" href="/_next/static/chunks/7ac61503aba6d10b58e3c266d97d99b7b5b3721a.c1b518faff21babf1a9f.js" as="script"/><link rel="preload" href="/_next/static/chunks/5f8a2089eac11fe3b358516a6b612033195d4834.64ceb811d7eabbf018a0.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/b/%5Bid%5D-eaf8ebe7ceed852553b5.js" as="script"/></head><body><div id="__next"><header><nav><ul><li><a id="site-name" href="/"><h1>te9yie</h1></a></li><li><a href="/b">Blog</a></li><li><a href="/w">Wiki</a></li><li><a href="/search">Search</a></li></ul></nav><h2>2021-03-03</h2></header><article><p>検索機能をつけたい。Google検索ができればよいと思い設定してみる。</p><p><a href="https://programmablesearchengine.google.com/">Programmable Search Engine</a></p><p>下記のコードをコピーして貼り付けてくれ、といわれたままやると<code>&lt;div&gt;</code>自体が見えなくなってうまく動かなかった。</p><pre><code class="language-html">&lt;script async src=&quot;https://cse.google.com/cse.js?cx=c961937a8b4f96e3d&quot;&gt;&lt;/script&gt;
&lt;div class=&quot;gcse-search&quot;&gt;&lt;/div&gt;</code></pre><p>まあ<a class="wiki-link" href="/w/React">React</a>だから<code>&lt;script&gt;</code>あたりの処理がうまく動かないのかなと思った。</p><p><code>useEffect</code>で対応してみた。</p><pre><code class="language-typescript">const SearchBox: React.FC = () =&gt; {
  const searchBoxRef = React.createRef&lt;HTMLDivElement&gt;();
  useEffect(() =&gt; {
    if (searchBoxRef &amp;&amp; searchBoxRef.current) {
      const searchBox = searchBoxRef.current;
      const parent = searchBox.parentNode;
      const gcse = document.createElement(&quot;script&quot;);
      gcse.async = true;
      gcse.src = &quot;https://cse.google.com/cse.js?cx=c961937a8b4f96e3d&quot;;
      parent?.insertBefore(gcse, searchBox);
    }
  });
  return (
    &lt;div className=&quot;search-box&quot;&gt;
      &lt;div ref={searchBoxRef} className=&quot;gcse-search&quot;&gt;&lt;/div&gt;
    &lt;/div&gt;
  );
};</code></pre><p>あと余白が大きくて邪魔だったので<a class="wiki-link" href="/w/CSS">CSS</a>も書いた。</p><pre><code class="language-css">.gsc-control-cse {
    padding: 0 !important;
}</code></pre></article><footer>© <!-- -->2021<!-- --> <!-- -->te9yie</footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"id":"2021-03-03","content":"検索機能をつけたい。Google検索ができればよいと思い設定してみる。\n\n[Programmable Search Engine](https://programmablesearchengine.google.com/)\n\n下記のコードをコピーして貼り付けてくれ、といわれたままやると`\u003cdiv\u003e`自体が見えなくなってうまく動かなかった。\n\n```html\n\u003cscript async src=\"https://cse.google.com/cse.js?cx=c961937a8b4f96e3d\"\u003e\u003c/script\u003e\n\u003cdiv class=\"gcse-search\"\u003e\u003c/div\u003e\n```\n\nまあ[[React]]だから`\u003cscript\u003e`あたりの処理がうまく動かないのかなと思った。\n\n`useEffect`で対応してみた。\n\n```typescript\nconst SearchBox: React.FC = () =\u003e {\n  const searchBoxRef = React.createRef\u003cHTMLDivElement\u003e();\n  useEffect(() =\u003e {\n    if (searchBoxRef \u0026\u0026 searchBoxRef.current) {\n      const searchBox = searchBoxRef.current;\n      const parent = searchBox.parentNode;\n      const gcse = document.createElement(\"script\");\n      gcse.async = true;\n      gcse.src = \"https://cse.google.com/cse.js?cx=c961937a8b4f96e3d\";\n      parent?.insertBefore(gcse, searchBox);\n    }\n  });\n  return (\n    \u003cdiv className=\"search-box\"\u003e\n      \u003cdiv ref={searchBoxRef} className=\"gcse-search\"\u003e\u003c/div\u003e\n    \u003c/div\u003e\n  );\n};\n```\n\nあと余白が大きくて邪魔だったので[[CSS]]も書いた。\n\n```css\n.gsc-control-cse {\n    padding: 0 !important;\n}\n```\n"}},"__N_SSG":true},"page":"/b/[id]","query":{"id":"2021-03-03"},"buildId":"6ITGa_4BtWY_kkzQctGtQ","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-4f4acd756cef4fe6da1b.js"></script><script src="/_next/static/chunks/main-1f0b73d383aed819e4f2.js" async=""></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.29f9e2f3d4a33bafbaa5.js" async=""></script><script src="/_next/static/chunks/commons.3a16fc34825ffc7ba561.js" async=""></script><script src="/_next/static/chunks/pages/_app-be08fdd24fededd721c6.js" async=""></script><script src="/_next/static/chunks/7ac61503aba6d10b58e3c266d97d99b7b5b3721a.c1b518faff21babf1a9f.js" async=""></script><script src="/_next/static/chunks/5f8a2089eac11fe3b358516a6b612033195d4834.64ceb811d7eabbf018a0.js" async=""></script><script src="/_next/static/chunks/pages/b/%5Bid%5D-eaf8ebe7ceed852553b5.js" async=""></script><script src="/_next/static/6ITGa_4BtWY_kkzQctGtQ/_buildManifest.js" async=""></script><script src="/_next/static/6ITGa_4BtWY_kkzQctGtQ/_ssgManifest.js" async=""></script></body></html>